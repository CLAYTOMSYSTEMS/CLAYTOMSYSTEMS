{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "PatchResponse",
  "description": "Esquema AJV (Draft-07) para validar la respuesta estructurada que genera los parches y metadatos para crear un PR automático.",
  "type": "object",
  "required": ["pr_title", "pr_body", "branch_name", "commits"],
  "properties": {
    "pr_title": {
      "type": "string",
      "minLength": 1,
      "description": "Título sugerido para el PR."
    },
    "pr_body": {
      "type": "string",
      "description": "Cuerpo/descripcion sugerida del PR."
    },
    "branch_name": {
      "type": "string",
      "pattern": "^[a-z0-9._\\/-]+$",
      "description": "Nombre de la rama que se creará (convención: gpt-suggest/...)."
    },
    "commits": {
      "type": "array",
      "minItems": 1,
      "description": "Lista de commits que se aplicarán en la nueva rama.",
      "items": { "$ref": "#/definitions/commit" }
    },
    "labels": {
      "type": "array",
      "description": "Etiquetas opcionales para añadir al PR/Issue.",
      "items": { "type": "string", "minLength": 1 }
    },
    "reviewers": {
      "type": "array",
      "description": "Lista opcional de reviewers a solicitar.",
      "items": { "type": "string", "minLength": 1 }
    }
  },
  "additionalProperties": false,
  "definitions": {
    "commit": {
      "type": "object",
      "required": ["message", "files"],
      "properties": {
        "message": { "type": "string", "minLength": 1 },
        "files": {
          "type": "array",
          "minItems": 1,
          "items": { "$ref": "#/definitions/file" }
        }
      },
      "additionalProperties": false
    },
    "file": {
      "type": "object",
      "required": ["path", "content"],
      "properties": {
        "path": {
          "type": "string",
          "minLength": 1,
          "description": "Ruta relativa del archivo dentro del repo (ej. src/index.ts)."
        },
        "content": {
          "type": "string",
          "description": "Contenido completo del archivo (archivo nuevo o actualizado)."
        }
      },
      "additionalProperties": false
    }
  }
}